% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  11pt,
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{setspace}
\usepackage{float}
\usepackage{mathtools}
\usepackage{natbib}
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\setcitestyle{numbers,square,comma}
\usepackage{verbatim}
\usepackage{amsthm}
\usepackage{comment}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  colorlinks=true,
  linkcolor={Maroon},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={blue},
  pdfcreator={LaTeX via pandoc}}

\author{}
\date{\vspace{-2.5em}}

\begin{document}

\newcommand{\diag}{\mathrm{diag}}
\newcommand{\tr}{\mathrm{Tr}}
\newcommand{\blockdiag}{\mathrm{blockdiag}}
\newcommand{\indep}{\stackrel{\mathrm{ind}}{\sim}}
\newcommand{\iid}{\stackrel{\mathrm{iid}}{\sim}}
\newcommand{\Bernoulli}{\mathrm{Bernoulli}}
\newcommand{\Betadist}{\mathrm{Beta}}
\newcommand{\BG}{\mathrm{BernoulliGraph}}
\newcommand{\Uniform}{\mathrm{Uniform}}
\newcommand{\PABM}{\mathrm{PABM}}
\newcommand{\RDPG}{\mathrm{RDPG}}
\newcommand{\GRDPG}{\mathrm{GRDPG}}
\newcommand{\Multinomial}{\mathrm{Multinomial}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\as}{\stackrel{\mathrm{a.s.}}{\to}}
\newcommand{\ER}{\text{Erd\"{o}s-R\'{e}nyi}}
\newcommand{\SBM}{\mathrm{SBM}}
\newcommand{\DCBM}{\mathrm{DCBM}}
\newcommand{\rank}{\mathrm{rank}}
\newcommand{\MBM}{\mathrm{MBM}}
\newcommand{\Poisson}{\mathrm{Poisson}}

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

\hypertarget{methods}{%
\section{Methods}\label{methods}}

\hypertarget{simulation-study}{%
\section{Simulation Study}\label{simulation-study}}

\hypertarget{classification}{%
\subsection{Classification}\label{classification}}

In this simulation experiment, the latent vectors were sampled along a
Bezier curve defined by
\(g(t) = \begin{bmatrix} t^2 & 2 t (1-t) \end{bmatrix}^\top\). The
timepoints \(t_i\) were sampled as iid Beta random variables with two
sets of parameters, \((\alpha_1, \beta_1)\) and \((\alpha_2, \beta_2)\).
The setup is as follows:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Draw response variables \(y_1, ..., y_n \iid \Multinomial(1/2, 1/2)\).
\item
  For each \(i = 1, ..., n\), draw
  \(t_i \mid y_i \indep \Betadist(\alpha_{y_i}, \beta_{y_i})\), such
  that

  \begin{itemize}
  \tightlist
  \item
    \(\alpha_1 = 1\)
  \item
    \(\beta_1 = 2\)
  \item
    \(\alpha_2 = 2\)
  \item
    \(\beta_2 = 1\)
  \end{itemize}
\item
  Construct each latent vector as \(x_i = g(t_i)\) and compile them in
  data matrix
  \(X = \begin{bmatrix} x_1 & \cdots & x_n \end{bmatrix}^\top\).
\item
  Sample graph and its adjacency matrix as \(A \sim \RDPG(X)\).
\end{enumerate}

For each graph, we constructed the ASE, which was used to estimate the
parameters \((\hat{\alpha}, \hat{\beta})\) for the graph, using the
maximum likelihood method. The estimated parameters were then used as
predictors \(y_1, ..., y_n\), setting aside half for training and half
for testing. We investigated graphs of size \(|V| = 32, 64, 128, 256\).
The number of graphs for each experiment was set to \(n = 64\). For each
(number of graphs, size of graph) pair, we performed 32 replicates.
Figure \ref{fig:class-sim-ase} shows the ASE of one graph.\\
Figure \ref{fig:classification-sim} shows the boxplots of the
classification error rates.

\begin{center}\includegraphics{draft_files/figure-latex/class-sim-ase-1} \end{center}

\begin{center}\includegraphics{draft_files/figure-latex/classification-sim-1} \end{center}

\hypertarget{regression}{%
\subsection{Regression}\label{regression}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Draw angles
  \(\theta_1, ..., \theta_N \iid \Uniform(\pi / 6, \pi / 3)\).
\item
  For each \(k = 1, ..., N\),

  \begin{enumerate}
  \def\labelenumii{\roman{enumii}.}
  \tightlist
  \item
    Draw \(t_1, ..., t_n \iid \Uniform(0, 1)\);
  \item
    Draw \(z_1, ..., z_n \iid \Multinomial(1/2, 1/2)\);
  \item
    For each \(i = 1, ..., n\), set
    \(x_i = \begin{cases} \begin{bmatrix} t_i & 0 \end{bmatrix}^\top & z_i = 1 \\ \begin{bmatrix} t_i \cos \theta_k & t_i \sin \theta_k \end{bmatrix}^\top & z_i = 2 \end{cases}\);
  \item
    Collect
    \(X = \begin{bmatrix} x_1 & \cdots & x_n \end{bmatrix}^\top\) and
    draw \(A \sim \RDPG(X)\);
  \item
    Set the response \(y_k = \beta_0 + \beta_1 \theta_k\).
  \end{enumerate}
\end{enumerate}

In this simulation, we set \(\beta_0 = \beta_1 = 1\). The number of
graphs was set to \(N = 64\), and the number of vertices per graph was
set to \(n = 128, 256, 512, 1024\). For each \(n\), we simulated 32
replicates.

\begin{center}\includegraphics{draft_files/figure-latex/angle-reg-example-1} \end{center}

\begin{center}\includegraphics{draft_files/figure-latex/angle-reg-results-1} \end{center}

\hypertarget{applications}{%
\section{Applications}\label{applications}}

In the first example, we analyzed fiber count data between brain regions
from the Human Connectome Project (HCP). When analyzing these data as
graphs, we denote the regions as vertices and the fiber counts between
pairs of regions as weighted edges. A plausible statistical model for
these data is to assume that the edge weights between pairs of vertices
is Poisson distributed, i.e., the adjacency matrix is sampled as
\(A_{ij} \indep \Poisson(\Theta_{ij})\), where
\(\Theta \in \mathbb{R}_+^{n \times n}\) is a symmetric matrix of
Poisson parameters.

In this dataset, there are \(N = 136\) graphs (corresponding to
individual subjects), each with \(n = 68\) vertices (corresponding to
brain regions). Analyzing these graphs as RDPGs reveals that the DCBM is
a good candidate for these data (fig \ref{fig:hcp-ase}).

\begin{figure}[H]

{\centering \includegraphics{draft_files/figure-latex/hcp-ase-1} 

}

\caption{ASE of one graph from the HCP dataset. The lines are fitted via $K$-curves clustering using degree = 1. The outputted clusters correspond exactly to the left (red) and right (blue) hemispheres.}\label{fig:hcp-ase}
\end{figure}

For each graph, the

\begin{center}\includegraphics{draft_files/figure-latex/hcp-gender-1} \end{center}

\begin{center}\includegraphics{draft_files/figure-latex/hcp-age-1} \end{center}

\hypertarget{discussion}{%
\section{Discussion}\label{discussion}}

\renewcommand\refname{Bibliography}
  \bibliography{bibliography.bib}

\end{document}
